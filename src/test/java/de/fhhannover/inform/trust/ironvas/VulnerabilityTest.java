/*
 * Project: ironvas
 * Package: test.java.de.fhhannover.inform.trust.ironvas
 * File:    VulnerabilityTest.java
 *
 * Copyright (C) 2011-2012 Fachhochschule Hannover
 * Ricklinger Stadtweg 118, 30459 Hannover, Germany 
 *
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package de.fhhannover.inform.trust.ironvas;

import java.util.Date;

import org.junit.Before;
import org.junit.Test;

import de.fhhannover.inform.trust.ironvas.Nvt;
import de.fhhannover.inform.trust.ironvas.RiskfactorLevel;
import de.fhhannover.inform.trust.ironvas.ThreatLevel;
import de.fhhannover.inform.trust.ironvas.Vulnerability;
import static org.junit.Assert.*;

public class VulnerabilityTest {
	
	private Vulnerability v1Equalsv2;
	private Vulnerability v2Equalsv1;
	private Vulnerability v3;
	private Vulnerability v4;
	private Vulnerability v5;
	
	@Before
	public void setUp() {
		Date date = new Date();
		
		v1Equalsv2 = new Vulnerability(
				"99aae6be-95e3-4ed6-a11b-6b1f20dd29e2",
				date,
				"10.0.0.101",
				"10.0.0.101",
				"general/tcp",
				ThreatLevel.High,
				"Overview: This host is installed with Wireshark and is prone to multiple  unspecified vulnerability.  Vulnerability Insight:  - Error exists while processing PN-DCP packet with format string specifiers    in PROFINET/DCP (PN-DCP) dissector.  - Error in unknown impact and attack vectors.  - Error in Lightweight Directory Access Protocol (LDAP) dissector when    processing unknown attack vectors.  - Error in Check Point High-Availability Protocol (CPHAP) when processing    crafted FWHA_MY_STATE packet.  - An error exists while processing malformed Tektronix .rf5 file.  Impact:  Successful exploitation could result in denial of serivce condition.  Impact Level: Application  Affected Software/OS:  Wireshark version 0.9.6 to 1.0.6 on Linux  Fix: Upgrade to Wireshark 1.0.7  http://www.wireshark.org/download.html  References:  http://milw0rm.com/exploits/8308  http://secunia.com/advisories/34778  http://secunia.com/advisories/34542  http://securitytracker.com/alerts/2009/Apr/1022027.html  CVSS Score:    CVSS Base Score     : 10.0 (AV:N/AC:L/Au:NR/C:C/I:C/A:C)    CVSS Temporal Score : 7.8  Risk factor: HighCVE : CVE-2009-1210, CVE-2009-1266, CVE-2009-1267, CVE-2009-1268, CVE-2009-1269BID : 34291, 34457",
				new Nvt("name1", "", 0.0f, RiskfactorLevel.Critical, "", "")
				);
		
		v2Equalsv1 = new Vulnerability(
				"99aae6be-95e3-4ed6-a11b-6b1f20dd29e2",
				date,
				"10.0.0.101",
				"10.0.0.101",
				"general/tcp",
				ThreatLevel.High,
				"Overview: This host is installed with Wireshark and is prone to multiple  unspecified vulnerability.  Vulnerability Insight:  - Error exists while processing PN-DCP packet with format string specifiers    in PROFINET/DCP (PN-DCP) dissector.  - Error in unknown impact and attack vectors.  - Error in Lightweight Directory Access Protocol (LDAP) dissector when    processing unknown attack vectors.  - Error in Check Point High-Availability Protocol (CPHAP) when processing    crafted FWHA_MY_STATE packet.  - An error exists while processing malformed Tektronix .rf5 file.  Impact:  Successful exploitation could result in denial of serivce condition.  Impact Level: Application  Affected Software/OS:  Wireshark version 0.9.6 to 1.0.6 on Linux  Fix: Upgrade to Wireshark 1.0.7  http://www.wireshark.org/download.html  References:  http://milw0rm.com/exploits/8308  http://secunia.com/advisories/34778  http://secunia.com/advisories/34542  http://securitytracker.com/alerts/2009/Apr/1022027.html  CVSS Score:    CVSS Base Score     : 10.0 (AV:N/AC:L/Au:NR/C:C/I:C/A:C)    CVSS Temporal Score : 7.8  Risk factor: HighCVE : CVE-2009-1210, CVE-2009-1266, CVE-2009-1267, CVE-2009-1268, CVE-2009-1269BID : 34291, 34457",
				new Nvt("name1", "", 0.0f, RiskfactorLevel.Critical, "", "")
				);
		v3 = new Vulnerability(
						"8b4ca6f5-1fbf-4108-9bae-a6de5b7e6583",
						new Date(),
						"10.0.0.101",
						"10.0.0.101",
						"general/tcp",
						ThreatLevel.High,
						"Overview: This host is installed with Wireshark and is prone to multiple  unspecified vulnerability.  Vulnerability Insight:  - Error exists while processing PN-DCP packet with format string specifiers    in PROFINET/DCP (PN-DCP) dissector.  - Error in unknown impact and attack vectors.  - Error in Lightweight Directory Access Protocol (LDAP) dissector when    processing unknown attack vectors.  - Error in Check Point High-Availability Protocol (CPHAP) when processing    crafted FWHA_MY_STATE packet.  - An error exists while processing malformed Tektronix .rf5 file.  Impact:  Successful exploitation could result in denial of serivce condition.  Impact Level: Application  Affected Software/OS:  Wireshark version 0.9.6 to 1.0.6 on Linux  Fix: Upgrade to Wireshark 1.0.7  http://www.wireshark.org/download.html  References:  http://milw0rm.com/exploits/8308  http://secunia.com/advisories/34778  http://secunia.com/advisories/34542  http://securitytracker.com/alerts/2009/Apr/1022027.html  CVSS Score:    CVSS Base Score     : 10.0 (AV:N/AC:L/Au:NR/C:C/I:C/A:C)    CVSS Temporal Score : 7.8  Risk factor: HighCVE : CVE-2009-1210, CVE-2009-1266, CVE-2009-1267, CVE-2009-1268, CVE-2009-1269BID : 34291, 34457",
						new Nvt("name1", "", 0.0f, RiskfactorLevel.Critical, "", "")
				);
		v4 = new Vulnerability(
						"",
						new Date(),
						"",
						"",
						"",
						ThreatLevel.High,
						"",
						new Nvt("name1", "", 0.0f, RiskfactorLevel.Critical, "", ""));
		v5 = new Vulnerability(
				"",
				new Date(),
				"",
				"",
				"",
				ThreatLevel.High,
				"",
				new Nvt("name2", "", 0.0f, RiskfactorLevel.Critical, "", ""));
	}
	
	@Test
	public void testEquals() {
		assertEquals(v1Equalsv2, v2Equalsv1);
		assertEquals(v2Equalsv1, v1Equalsv2);
		assertFalse(v1Equalsv2.equals(v3));
		assertFalse(v3.equals(v1Equalsv2));
		
		assertFalse(v4.equals(v5));
		assertFalse(v5.equals(v4));
	}
	
	@Test
	public void testHashCode() {
		assertEquals(v1Equalsv2.hashCode(), v2Equalsv1.hashCode());
		assertFalse(v1Equalsv2.hashCode() == v3.hashCode());
		
		assertFalse(v4.hashCode() == v5.hashCode());
	}
	
	

}